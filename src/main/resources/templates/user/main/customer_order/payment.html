<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/user/common/layout/mainLayout}"
      layout:fragment="Content">

<link rel="stylesheet" href="/user/customer_order/css/payment.css">

<div id="member-check" th:data-member="${memberDTO != null ? true : false}"></div>
<div class="inner" th:if="${memberDTO != null}">
    <!-- 상단 제목 -->
    <section id="pay-header">
        <h3 class="header-title">주문/결제</h3>
        <div class="order-process">
            <p>장바구니</p>
            <img src="/user/customer_order/img/arrow-right=off.svg" alt="화살표">
            <p class="bold">결제하기</p>
            <img src="/user/customer_order/img/arrow-right=on.svg" alt="화살표">
            <p>주문완료</p>
        </div>
    </section>
    <div id="payment-section">
        <!-- 배송지정보 -->
        <section id="deliver-info">
            <div class="addr-info">
                <p class="sub-title">배송지 정보</p>
                <div class="user-info">
                    <p id="deliver-name" th:text="${memberDTO.member_name}"></p>
                    <p id="deliver-number" th:text="${memberDTO.member_phoneNo}"></p>
                    <div class="addr-wrap">
                        <div class="addr-text">
                            <p id="deliver-addr" th:text="${memberDTO.member_addr}"></p>
                            <p id="deliver-addr-detail" th:text="${memberDTO.member_detail_addr}"></p>
                        </div>
                        <button class="default-btn border" id="edit-btn">변경</button>
                    </div>
                </div>
            </div>
            <div class="select-enter-way">
                <p class="sub-title">공동현관 출입방법</p>
                <div class="door-info">
                    <div class="radio-wrap">
                        <div class="common-door">
                            <input type="radio" name="door-way" id="door-pw" checked>
                            <label for="door-pw">공동현관 비밀번호</label>
                        </div>
                        <div class="free-door">
                            <input type="radio" name="door-way" id="door-free">
                            <label for="door-free">자유출입 가능</label>
                        </div>
                    </div>
                    <div class="input-wrap">
                        <input type="text" name="common_ent_pw" id="common_ent_pw"
                               placeholder="정확한 공동현관 출입번호(비밀번호)를 입력해주세요.">
                        <p>※ 공동현관 출입방법 정보가 정확하지 않을 경우, 새벽배송 시 공동현관 앞에 배송되거나 반송될 수 있습니다.</p>
                    </div>
                </div>
            </div>

            <!-- 주소변경모달 -->
            <div id="edit-addr-modal">
                <div class="modal-head">
                    <h3>배송지 수정</h3>
                    <i class="fa-solid fa-xmark" id="close-btn"></i>
                </div>
                <div class="addr-edit-wrap">
                    <div class="edit-input person-name">
                        <p class="edit-subtitle">받는 분</p>
                        <input type="text" name="" id="edit-name" placeholder="이름" th:value="${memberDTO.member_name}">
                    </div>
                    <div class="edit-input phone-number">
                        <p class="edit-subtitle">전화번호</p>
                        <input type="text" name="" id="edit-number" placeholder="전화번호" th:value="${memberDTO.member_phoneNo}"
                               oninput="hyphenTel(this)">
                    </div>
                    <div class="edit-input change-addr">
                        <p class="edit-subtitle">주소</p>
                        <div class="search-addr">
                            <div class="addr-top">
                                <div class="addr-input-box">
                                    <input type="text" name="order_addr" id="edit-addr"
                                           th:value="${memberDTO.member_addr}">
                                </div>
                                <button type="button" class="default-btn" id="search-btn">검색</button>
                            </div>
                            <input type="text" name="order_addr_detail" id="edit-addr-detail"
                                   th:value="${memberDTO.member_detail_addr}">
                        </div>
                    </div>
                    <button class="default-btn" id="confirm-btn">확인</button>
                </div>
            </div>
        </section>

        <!-- 결제 정보 -->
        <section id="pay-info">
            <div class="top">
                <div class="price-wrap">
                    <p>상품금액</p>
                    <div class="price">
                        <p th:text="${totalPrice != null ? #numbers.formatInteger(totalPrice, 0, 'COMMA') : 0}"></p>
                        <p>원</p>
                    </div>
                </div>
                <div class="deliver-fee">
                    <p>배송비</p>
                    <p>무료</p>
                </div>
            </div>
            <div class="bottom">
                <div class="total-wrap">
                    <p>최종 결제 금액</p>
                    <div class="price">
                        <p th:text="${totalPrice != null ? #numbers.formatInteger(totalPrice, 0, 'COMMA') : 0}"></p>
                        <p>원</p>
                    </div>
                </div>
                <button class="default-btn" id="pay-btn" th:disabled="${orderCartItems == null && orderItems == null}">결제하기</button>
            </div>
        </section>

        <!-- 상품정보 -->
        <section id="product-info">
            <div class="product-head">
                <div class="left">
                    <p class="product-name">주문상품</p>
                    <div class="total-cnt">
                        <p>총</p>
                        <p class="book-cnt" th:text="${itemsCnt != null ? itemsCnt : 0}"></p>
                        <p>개</p>
                    </div>
                </div>
                <i class="fa-solid fa-angle-down product-info-arrow"></i>
            </div>
            <div class="list-wrap">
                <div class="result-wrap" th:if="${orderItems == null && orderCartItems == null}">
                    <p>!</p>
                    <span>상품이 없습니다</span>
                </div>
                <div class="product-list" th:each="item : ${orderItems}">
                    <div class="list-left">
                        <div class="img-wrap">
                            <img th:src="${item.book_thumbnail_changed != null ? '/images/books/' + item.book_thumbnail_changed : '/images/books/noimg.png'}"
                                 alt="책사진">
                        </div>
                        <p class="book-name" th:text="${item.book_name}"></p>
                    </div>
                    <div class="list-right">
                        <div class="books-cnt">
                            <p th:text="${item.cart_purchase_qty}"></p>
                            <p>개</p>
                        </div>
                        <div class="book-price">
                            <p th:text="${#numbers.formatInteger(item.book_price, 0, 'COMMA')}"></p>
                            <p>원</p>
                        </div>
                    </div>
                </div>
                <div class="product-list" th:each="cartitem : ${orderCartItems}">
                    <div class="list-left">
                        <div class="img-wrap">
                            <img th:src="${cartitem.book_thumbnail_changed != null ? '/images/books/' + cartitem.book_thumbnail_changed : '/images/books/noimg.png'}"
                                 alt="책사진">
                        </div>
                        <p class="book-name" th:text="${cartitem.book_name}"></p>
                    </div>
                    <div class="list-right">
                        <div class="books-cnt">
                            <p th:text="${cartitem.cart_purchase_qty}"></p>
                            <p>개</p>
                        </div>
                        <div class="book-price">
                            <p th:text="${#numbers.formatInteger(cartitem.book_price, 0, 'COMMA')}"></p>
                            <p>원</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 결제 동의 -->
        <section id="pay-agree">
            <h3>위 주문내용을 확인하였으며, 결제에 동의합니다.</h3>
            <div class="agree-content product">
                <div class="agree-title">
                    <p>주문 상품 정보 동의</p>
                    <i class="fa-solid fa-angle-down agree-arrow"></i>
                </div>
                <div class="agree-text">
                    주문할 상품의 상품명, 가격, 배송정보 등을 최종 확인하였으며, 구매에 동의하십니까? (전자상거래법 제 8조 2항)
                </div>
            </div>
            <div class="agree-content private">
                <div class="agree-title">
                    <p>개인정보 수집 및 이용동의</p>
                    <i class="fa-solid fa-angle-down agree-arrow"></i>
                </div>
                <div class="agree-text"></div>
            </div>
        </section>
    </div>
</div>

<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script src="/user/customer_order/js/payment.js"></script>
</html>