<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="UserOrderRequest">

	<select id="cancleList" parameterType="Integer" resultType="customerOrderWithDetails">
		SELECT
	    co.order_num,
	    co.order_purchase_date,
	    b.book_thumbnail_changed,
	    b.book_name,
	    cod.order_detail_qty,
	    cod.order_detail_price
	FROM
	    customer_orders        co
	    LEFT JOIN customer_order_details cod ON co.order_num = cod.order_num
	    LEFT JOIN books                  b ON cod.book_isbn = b.book_isbn
	WHERE
	    co.order_num = #{orderNum}
	</select>
	
	<update id="orderDateModify" parameterType="Integer">
		UPDATE customer_orders
		SET
		    order_modify_date = current_timestamp
		WHERE
		    order_num = #{orderNum}
	</update>
	
	<update id="orderCancle" parameterType="Integer">
		UPDATE customer_order_details
		SET
		    order_detail_status = '02'
		WHERE
		    order_num = #{orderNum} AND order_detail_status = '01'
	</update>
</mapper>