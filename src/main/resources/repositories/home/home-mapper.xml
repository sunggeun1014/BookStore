<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Home">

    <select id="getProductsCnt" resultType="int">
        SELECT count(*)
        FROM books
        WHERE book_state = '01'
    </select>

    <select id="getMembersCnt" resultType="int">
        SELECT count(*)
        FROM members
    </select>

    <select id="getTodayOrder" resultType="int">
        SELECT COUNT(*)
        FROM customer_orders
        WHERE ORDER_PAYMENT_STATUS = '01'
        AND order_purchase_date BETWEEN
        TRUNC(FROM_TZ(CAST(SYSDATE AS TIMESTAMP), 'UTC') AT TIME ZONE 'Asia/Seoul')
        AND TRUNC(FROM_TZ(CAST(SYSDATE AS TIMESTAMP), 'UTC') AT TIME ZONE 'Asia/Seoul') + INTERVAL '1' DAY - INTERVAL '1' SECOND
    </select>


    <select id="getTodaySales" resultType="int">
        SELECT SUM(cod.order_detail_price)
        FROM customer_order_details cod
        INNER JOIN customer_orders co
        ON cod.order_num = co.order_num
        WHERE cod.order_detail_status = '01'
        AND co.order_purchase_date BETWEEN
        TRUNC(FROM_TZ(CAST(SYSDATE AS TIMESTAMP), 'UTC') AT TIME ZONE 'Asia/Seoul')
        AND TRUNC(FROM_TZ(CAST(SYSDATE AS TIMESTAMP), 'UTC') AT TIME ZONE 'Asia/Seoul') + INTERVAL '1' DAY - INTERVAL '1' SECOND
    </select>


    <!-- 배송전(주문) -->
    <select id="getAllOrders" resultType="int">
        SELECT count(*)
        FROM customer_orders
        WHERE order_delivery_status = '01'
    </select>

    <!-- 배송중 -->
    <select id="getAllDelivering" resultType="int">
        SELECT count(*)
        FROM customer_orders
        WHERE order_delivery_status = '02'
    </select>

    <!-- 배송완료 -->
    <select id="getAllCompleted" resultType="int">
        SELECT count(*)
        FROM customer_orders
        WHERE order_delivery_status = '03'
    </select>

</mapper>